## 跨域
> https://juejin.im/post/5c23993de51d457b8c1f4ee1
### 1.同源
* 1.同源指的是```协议+域名+端口```三者相同
* 2.同源限制的内容有:
    * Cookie, LocalStorage, IndexedDB等存储性的内容
    * DOM节点
    * AJAX请求发送后，结果被浏览器拦截了
* 3.允许跨域加载资源的标签
    * <img src=XXX>
    * <link href=XXX>
    * <script src=XXX>
### 2.跨域
* 当协议、主域名、子域名、端口号中任意一个不相同时，都算作不同域
* 跨域请求能发出去，服务端能收到请求并返回结果，只是结果被浏览器拦截了。
### 3.跨域方案
* 1.JSONP
    * 1.利用<script>标签没有跨域限制的漏洞
    * 2.回调传参的形式，获取参数
    * 3.缺点是仅支持get方法，不安全，可能遭受xss攻击
    * 4.实现:
    ```js
    // 服务器端
    var express = require('express');
    var app = express();
    var url = require('url');

    app.get('/test', function(req, res, next) {
        var data = 'hah, this is jsonp'
        var params = url.parse(req.url, true).query;
        res.send(`${params.callback}(${JSON.stringify(data)})`);
    });

    app.listen(8088);
    ```
    ```js
    // 客户端
    function jsonp({ url, callback }) {
        return new Promise((resolve, reject) => {
            let script = document.createElement('script')
            window[callback] = function(data) {
                resolve(data)
                document.body.removeChild(script)
            }
            script.src = `${url}?callback=${callback}`
            document.body.appendChild(script)
        })
    }
    jsonp({
        url: 'http://localhost:8088/test',
        callback: 'callback'
    }).then(data => {
        console.log(data)
    })
    ```
* 2.